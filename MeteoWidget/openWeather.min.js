/*!

Name: Open Weather
Dependencies: jQuery, OpenWeatherMap API
Author: Michael Lynch
Author URL: http://michaelynch.com
Date Created: August 28, 2013
Licensed under the MIT license

*/
!function(e){e.fn.openWeather=function(t){if(!this.length)return this;var n,a={descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,units:"c",city:null,lat:null,lng:null,key:null,lang:"en",success:function(){},error:function(e){}},r=this,l=e(this);r.settings={},r.settings=e.extend({},a,t);var i=r.settings;n="//api.openweathermap.org/data/2.5/weather?lang="+i.lang,null!=i.city?n+="&q="+i.city.replace(" ",""):null!=i.lat&&null!=i.lng&&(n+="&lat="+i.lat+"&lon="+i.lng),null!=i.key&&(n+="&appid="+i.key);var u=function(e){var t=1e3*e,n=new Date(t),a=n.getHours();a>12&&(hoursRemaining=24-a,a=12-hoursRemaining);var r=n.getMinutes();r=r.toString(),r.length<2&&(r=0+r);var l=a+":"+r;return l};e.ajax({type:"GET",url:n,dataType:"jsonp",success:function(t){if("f"==i.units)var n=Math.round(1.8*(t.main.temp-273.15)+32)+"°F",a=Math.round(1.8*(t.main.temp_min-273.15)+32)+"°F",r=Math.round(1.8*(t.main.temp_max-273.15)+32)+"°F";else var n=Math.round(t.main.temp-273.15)+"°C",a=Math.round(t.main.temp_min-273.15)+"°C",r=Math.round(t.main.temp_max-273.15)+"°C";if(l.html(n),null!=i.minTemperatureTarget&&e(i.minTemperatureTarget).text(a),null!=i.maxTemperatureTarget&&e(i.maxTemperatureTarget).text(r),e(i.descriptionTarget).text(t.weather[0].description),null!=i.iconTarget&&null!=t.weather[0].icon){if(null!=i.customIcons){var s,g,o=t.weather[0].icon;g=-1!=o.indexOf("d")?"day":"night",("01d"==o||"01n"==o)&&(s="clear"),("02d"==o||"02n"==o||"03d"==o||"03n"==o||"04d"==o||"04n"==o)&&(s="clouds"),("09d"==o||"09n"==o||"10d"==o||"10n"==o)&&(s="rain"),("11d"==o||"11n"==o)&&(s="storm"),("13d"==o||"13n"==o)&&(s="snow"),("50d"==o||"50n"==o)&&(s="mist");var m=i.customIcons+g+"/"+s+".png"}else var m="http://openweathermap.org/img/w/"+t.weather[0].icon+".png";e(i.iconTarget).attr("src",m)}if(null!=i.placeTarget&&e(i.placeTarget).text(t.name+", "+t.sys.country),null!=i.windSpeedTarget&&e(i.windSpeedTarget).text(Math.round(t.wind.speed)+" Mps"),null!=i.humidityTarget&&e(i.humidityTarget).text(t.main.humidity+"%"),null!=i.sunriseTarget){var c=u(t.sys.sunrise);e(i.sunriseTarget).text(c+" AM")}if(null!=i.sunsetTarget){var d=u(t.sys.sunset);e(i.sunsetTarget).text(d+" PM")}i.success.call(this)},error:function(e,t,n){i.error.call(this,t)}})}}(jQuery);
